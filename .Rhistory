tibble(shs) %>%
mutate(map_chr(shs,function(sh)paste0(round(sh,2),collapse=',')))
div <-
tibble(shs) %>%
mutate(name=map_chr(shs,function(sh)paste0(round(sh,2),collapse=',')),
hhi=map_dbl(shs,hhi),
ep=map_dbl(ep))
div <-
tibble(shs) %>%
mutate(name=map_chr(shs,function(sh)paste0(round(sh,2),collapse=',')),
hhi=map_dbl(shs,hhi))
div
purrr::map_dbl(shs,ep)
div <-
tibble(shs) %>%
mutate(name=map_chr(shs,function(sh)paste0(round(sh,2),collapse=',')),
hhi=map_dbl(shs,hhi),
ep=map_dbl(shs,ep))
div
div %>% arrange(hhi)
div %>% arrange(ep)
div %>% arrange(hhi)
hhi(c(0.8,0.2))
hhi(c(0.9,0.1))
hhi(c(0.95,0.05))
hhi(c(0.99,0.01))
#Plot hhi and ep with pop consisting of two and three groups
div <-
tibble(p=1:100/100)
div
#Plot hhi and ep with pop consisting of two and three groups
div <-
tibble(p=0:20/20)
div
hhi(c(0.8,1-0.8))
#Plot hhi and ep with pop consisting of two and three groups
div <-
tibble(p=0:20/20) %>%
mutate(hhi=map_dbl(p,function(p)hhi(c(p,1-p))))
div
#Plot hhi and ep with pop consisting of two and three groups
div <-
tibble(p=0:20/20) %>%
mutate(hhi=map_dbl(p,function(p)hhi(c(p,1-p))),
ep=map_dbl(p,function(p)ep(c(p,1-p))))
div
div %>%
gather(key,value,-p)
div %>%
gather(key,value,-p) %>%
ggplot(aes(p,value,color=key)) +
geom_line()
#Plot hhi and ep with pop consisting of two and three groups
div2 <-
tibble(p=0:20/20) %>%
mutate(hhi=map_dbl(p,function(p)hhi(c(p,1-p))),
ep=map_dbl(p,function(p)ep(c(p,1-p))))
div2 %>%
gather(key,value,-p) %>%
ggplot(aes(p,value,color=key)) +
geom_line()
div3 <-
expand.grid(0:20/20)
div3 <-
expand.grid(0:20/20,0:20/20)
div3
div3 <-
expand.grid(0:20/20,0:20/20) %>%
tibble()
div3
div3 <-
expand.grid(0:20/20,0:20/20) %>%
as_tibble()
div3
?as_tibble
div3 <-
expand.grid(0:20/20,0:20/20) %>%
as_tibble(colnames=c('1','2'))
div3
div3 <-
expand.grid(0:20/20,0:20/20) %>%
as_tibble() %>%
filter(Var1+Var2<=1)
div3
div3 <-
expand.grid(0:20/20,0:20/20) %>%
as_tibble() %>%
filter(Var1+Var2<=1) %>%
mutate(Var3=1-Var1-Var2)
div3
div3 <-
expand.grid(0:10/10,0:10/10) %>%
as_tibble() %>%
filter(Var1+Var2<=1) %>%
mutate(Var3=1-Var1-Var2,
hhi=map_dbl(p,function(p)hhi(c(Var1,Var2,Var3))),
ep=map_dbl(p,function(p)ep(c(Var1,Var2,Var3))))
div3 <-
expand.grid(0:10/10,0:10/10) %>%
as_tibble() %>%
filter(Var1+Var2<=1) %>%
mutate(Var3=1-Var1-Var2,
hhi=pmap_dbl(list(Var1,Var2,Var3),function(p1,p2,p3)hhi(c(p1,p2,p3))),
ep=pmap_dbl(p,function(p)ep(c(Var1,Var2,Var3))))
div3 <-
expand.grid(0:10/10,0:10/10) %>%
as_tibble() %>%
filter(Var1+Var2<=1) %>%
mutate(Var3=1-Var1-Var2,
hhi=pmap_dbl(list(Var1,Var2,Var3),function(p1,p2,p3)hhi(c(p1,p2,p3))))
div3
div3 <-
expand.grid(0:10/10,0:10/10) %>%
as_tibble() %>%
filter(Var1+Var2<=1) %>%
mutate(Var3=1-Var1-Var2,
hhi=pmap_dbl(list(Var1,Var2,Var3),function(p1,p2,p3)hhi(c(p1,p2,p3))),
ep=pmap_dbl(list(Var1,Var2,Var3),function(p1,p2,p3)ep(c(p1,p2,p3))))
div3
div3 %>%
select(-ep)
div3 %>%
select(-ep) %>%
ggplot(aes(Var1,Var2,fill=hhi)) +
geom_tile()
div3_ep_plt <-
div3 %>%
select(-hhi) %>%
ggplot(aes(Var1,Var2,fill=ep)) +
geom_tile()
div3_ep_plt
div3 <-
expand.grid(0:5/5,0:5/5) %>%
as_tibble() %>%
filter(Var1+Var2<=1) %>%
mutate(Var3=1-Var1-Var2,
hhi=pmap_dbl(list(Var1,Var2,Var3),function(p1,p2,p3)hhi(c(p1,p2,p3))),
ep=pmap_dbl(list(Var1,Var2,Var3),function(p1,p2,p3)ep(c(p1,p2,p3))))
div3_hhi_plt <-
div3 %>%
select(-ep) %>%
ggplot(aes(Var1,Var2,fill=hhi)) +
geom_tile()
div3_ep_plt <-
div3 %>%
select(-hhi) %>%
ggplot(aes(Var1,Var2,fill=ep)) +
geom_tile()
gridExtra::grid.arrange(div3_hhi_plt,div3_ep_plt)
gridExtra::grid.arrange(div3_hhi_plt,div3_ep_plt,ncol=2)
library(tidyverse)
n <- 1000
rep(c(T,F),n)
d <- tibble(st=rnorm(n*2),tr=rep(c(T,F),n))
d
pr <- rnorm(n)
po <- rnorm(n)
d1 <- tibble(st=c(pr,po),tr=c(rep(F,n),rep(T,n)))
d2 <- tibble(pr=pr,po=po)
library(tidyverse)
n <- 2000
pr <- rnorm(n)
po <- 0.75*pr + rnorm(n)
d1 <- tibble(st=c(pr,po),tr=c(rep(F,n),rep(T,n)))
d2 <- tibble(pr=pr,po=po)
d1
id <- factor(1:n)
d1 <- tibble(id=rep(id,2),
st=c(pr,po),
tr=c(rep(F,n),rep(T,n)))
d1
d2 <- tibble(pr=pr,
po=po)
lm(st~tr,d1)
fes <- d1 %>% group_by(id) %>% summarise(fe=mean(st))
fes
d1 %>% left_join(fes)
d1 <- d1 %>% left_join(fes) %>% mutate(adj_st=st-fe)
d1
lm(adj_st~tr,d1)
mean(po-pr)
po <- 0.75 + pr + rnorm(n)
mean(po-pr)
d1 <- tibble(id=rep(id,2),
st=c(pr,po),
tr=c(rep(F,n),rep(T,n)))
fes <- d1 %>% group_by(id) %>% summarise(fe=mean(st))
d1 <- d1 %>% left_join(fes) %>% mutate(adj_st=st-fe)
d2 <- tibble(pr=pr,
po=po)
lm(st~tr,d1)
lm(adj_st~tr,d1)
n <- 2500
id <- factor(1:n)
pr <- rnorm(n)
po <- 0.75 + pr + rnorm(n)
d1 <- tibble(id=rep(id,2),
st=c(pr,po),
tr=c(rep(F,n),rep(T,n)))
fes <- d1 %>% group_by(id) %>% summarise(fe=mean(st))
d1 <- d1 %>% left_join(fes) %>% mutate(adj_st=st-fe)
d2 <- tibble(pr=pr,
po=po)
lm(st~tr,d1)
lm(adj_st~tr,d1)
summary(lm(st~tr,d1))
summary(lm(adj_st~tr,d1))
summary(lm(po-pr~1,d2))
library(pwr)
1:10
1:10/10
0:10/10
0:20/10
0:10/10
ds <- c(1,2.5,5,10)
?seq
seq(0,100-5)
seq(0,100-10)
pows <- function(d) {
map(seq(0,100-d), function(p1) pwr.2p.test(h=ES.h(p1,p1+d)))
}
pows(5)
library(tidyverse)
library(tidyverse)
library(pwr)
pows <- function(d) {
map(seq(0,100-d), function(p1) pwr.2p.test(h=ES.h(p1,p1+d)))
}
pows(5)
pows <- function(d) {
map(seq(0,100-d), function(p1)
pwr.2p.test(h=ES.h(p1,p1+d),power=0.8,sig.level=0.05))
}
pows(5)
pows <- function(d) {
map(seq(0,100-d)/100, function(p1)
pwr.2p.test(h=ES.h(p1,p1+d),
power=0.8,
sig.level=0.05))
}
pows(5)
pows <- function(d) {
map(seq(1,100-d-1)/100, function(p1)
pwr.2p.test(h=ES.h(p1,p1+d),
power=0.8,
sig.level=0.05))
}
pwr.2p.test(h=ES.h(0,),power=0.8,sig.level=0.05)
#pwr.2p.test(h=ES.h(0,),power=0.8,sig.level=0.05)
pows(5)
pows <- function(d) {
p1s <- seq(1,100-d-1)/100
return(p1s)
map(, function(p1)
pwr.2p.test(h=ES.h(p1,p1+d),
power=0.8,
sig.level=0.05))
}
#pwr.2p.test(h=ES.h(0,),power=0.8,sig.level=0.05)
pows(5)
pows <- function(d) {
p1s <- seq(1,100-d-1)/100
return(p1s)
map(p1s, function(p1)
pwr.2p.test(h=ES.h(p1,p1+d/100),
power=0.8,
sig.level=0.05))
}
pows(0.05)
pows <- function(d) {
p1s <- seq(1,100-d-1)/100
#return(p1s)
map(p1s, function(p1)
pwr.2p.test(h=ES.h(p1,p1+d/100),
power=0.8,
sig.level=0.05))
}
pows(0.05)
pows <- function(d) {
p1s <- seq(25,75-d-1)/100
#return(p1s)
map(p1s, function(p1)
pwr.2p.test(h=ES.h(p1,p1+d/100),
power=0.8,
sig.level=0.05))
}
pows(0.05)
pows(5)
pows(5)[[1]]
str(pows(5)[[1]])
pows(5)[[1]]$n
pows <- function(d) {
p1s <- seq(25,75-d-1)/100
#return(p1s)
map(p1s, function(p1)
pwr.2p.test(h=ES.h(p1,p1+d/100),
power=0.8,
sig.level=0.05)$n)
}
pows <- function(d) {
p1s <- seq(25,75-d-1)/100
#return(p1s)
map_dbl(p1s, function(p1)
pwr.2p.test(h=ES.h(p1,p1+d/100),
power=0.8,
sig.level=0.05)$n)
}
pows(5)
pows(1)
pows(10)
?pwr.2p.test
ds <- c(2.5,5,10)
pows <- function(d) {
p1s <- seq(25,75-d-1)/100
ns <- map_dbl(p1s, function(p1)
pwr.2p.test(h=ES.h(p1,p1+d/100),
power=0.8,
sig.level=0.05)$n)
data_frame(p1=p1s,n=ns)
}
pows(10)
pows <- function(d) {
p1s <- seq(25,75-d-1)/100
ns <- map_dbl(p1s, function(p1)
pwr.2p.test(h=ES.h(p1,p1+d/100),
power=0.8,
sig.level=0.05)$n)
tibble(p1=p1s,n=ns)
}
pows(10)
pows <- function(d) {
p1s <- seq(5,100-d-1)/100
ns <- map_dbl(p1s, function(p1)
pwr.2p.test(h=ES.h(p1,p1+d/100),
power=0.8,
sig.level=0.05)$n)
tibble(p1=p1s,n=ns)
}
pows(10)
pows <- function(d) {
p1s <- seq(50,100-d-1)/100
ns <- map_dbl(p1s, function(p1)
pwr.2p.test(h=ES.h(p1,p1+d/100),
power=0.8,
sig.level=0.05)$n)
tibble(p1=p1s,n=ns)
}
pows(10)
pows_list <- map(ds,pows)
pows_list[[1]]
pows_list[[1]] %>%
ggplot() %>% geom_line()
pows_list[[1]] %>%
ggplot() + geom_line()
pows_list[[1]] %>%
ggplot() + geom_line(p1,n)
pows_list[[1]] %>%
ggplot(aes(p1,n)) + geom_line()
pows <- function(d) {
p1s <- seq(1,100-d-1)/100
ns <- map_dbl(p1s, function(p1)
pwr.2p.test(h=ES.h(p1,p1+d/100),
power=0.8,
sig.level=0.05)$n)
tibble(p1=p1s,n=ns)
}
ds <- c(2.5,5,10)
pows_list <- map(ds,pows)
pows_list[[1]] %>%
ggplot(aes(p1,n)) + geom_line()
pows <- function(d) {
p1s <- seq(5,100-d-1)/100
ns <- map_dbl(p1s, function(p1)
pwr.2p.test(h=ES.h(p1,p1+d/100),
power=0.8,
sig.level=0.05)$n)
tibble(p1=p1s,n=ns)
}
ds <- c(2.5,5,10)
pows_list <- map(ds,pows)
pows_list[[1]] %>%
ggplot(aes(p1,n)) + geom_line()
p1s <- seq(10,100-11)/100
pows <- function(d) {
p1s <- seq(10,100-11)/100
ns <- map_dbl(p1s, function(p1)
pwr.2p.test(h=ES.h(p1,p1+d/100),
power=0.8,
sig.level=0.05)$n)
tibble(p1=p1s,n=ns)
}
ds <- c(2.5,5,10)
pows_list <- map(ds,pows)
pows_list[[1]] %>%
ggplot(aes(p1,n)) + geom_line()
pows <- function(d) {
p1s <- seq(d,100-d-1)/100
ns <- map_dbl(p1s, function(p1)
pwr.2p.test(h=ES.h(p1,p1+d/100),
power=0.8,
sig.level=0.05)$n)
tibble(p1=p1s,n=ns)
}
ds <- c(2.5,5,10)
pows_list <- map(ds,pows)
pows_list[[1]] %>%
ggplot(aes(p1,n)) + geom_line()
pows <- function(d) {
p1s <- seq(1,100-d-1)/100
ns <- map_dbl(p1s, function(p1)
pwr.2p.test(h=ES.h(p1,p1+d/100),
power=0.8,
sig.level=0.05)$n)
tibble(p1=p1s,n=ns)
}
ds <- c(2.5,5,10)
pows_list <- map(ds,pows)
pows_list[[1]] %>%
ggplot(aes(p1,n)) + geom_line()
pows <- function(d) {
p1s <- seq(5,100-d-1)/100
ns <- map_dbl(p1s, function(p1)
pwr.2p.test(h=ES.h(p1,p1+d/100),
power=0.8,
sig.level=0.05)$n)
tibble(p1=p1s,n=ns)
}
ds <- c(2.5,5,10)
pows_list <- map(ds,pows)
pows_list[[1]] %>%
ggplot(aes(p1,n)) + geom_line()
pows <- function(d) {
p1s <- seq(1,100-d-1)/100
ns <- map_dbl(p1s, function(p1)
pwr.2p.test(h=ES.h(p1,p1+d/100),
power=0.8,
sig.level=0.05)$n)
tibble(p1=p1s,n=ns)
}
ds <- c(2.5,5,10)
pows_list <- map(ds,pows)
pows_list[[1]] %>%
ggplot(aes(p1,n)) + geom_line()
plts <-
map2(ds,pows_list,
function(x,y)
y %>% ggplot(aes(p1,n)) +
geom_line() +
ggtitle(str_c('Difference = ',d)))
plts <-
map2(ds,pows_list,
function(x,y)
y %>% ggplot(aes(p1,n)) +
geom_line() +
ggtitle(str_c('difference = ',x)))
gridExtra::grid.arrange(plts)
gridExtra::grid.arrange(grobs=plts)
?grid.arrange
gridExtra::grid.arrange(grobs=plts,ncol=3)
pows <- function(d) {
p1s <- seq(1,100-d-1)/100
ns <- map_dbl(p1s, function(p1)
pwr.2p.test(h=ES.h(p1,p1+d/100),
power=0.8,
sig.level=0.05)$n)
tibble(p1=p1s*100,n=ns)
}
ds <- c(2.5,5,10)
pows_list <- map(ds,pows)
plts <-
map2(ds,pows_list,
function(x,y)
y %>% ggplot(aes(p1,n)) +
geom_line() +
ggtitle(str_c('difference = ',x)))
gridExtra::grid.arrange(grobs=plts,ncol=3)
install.packages('stargazer')
library(stargazer)
setwd("C:/Users/xzp689/Google Drive/Studie & Arbejde/PHD/Teaching/Basecamp/basecamp_stats_intro")
read.csv('origin_mobility.csv')
d <- read.csv('origin_mobility.csv')
library(stargazer)
d <- read.csv('origin_mobility.csv')
head(d)
colnames(d)
library(tidyverse)
colnames(d)
preds <- c(
'german',
'british',
'south',
'german+british',
'german+south',
'british+south',
'german+british+south'
)
str_c('mobility~',preds)
map(str_c('mobility~',preds),
function(form)lm(form,d))
mods <-
map(str_c('mobility~',preds),
function(form)lm(form,d))
stargazer(mods)
stargazer(mods,type='text')
stargazer(mods,type='text')
stargazer(mods,type='text',no.space=T)
stargazer(mods,type='text',no.space=T,keep.stat=c('rsqrd'))
stargazer(mods,type='text',no.space=T,keep.stat=c('rsq'))
stargazer(mods,type='text',´ci=T,
no.space=T,keep.stat=c('rsq'))
stargazer(mods,type='text',ci=T,
no.space=T,keep.stat=c('rsq'))
